#!/bin/bash
############################################################################################################################
#
# Outsourcer UI start script.
#       
############################################################################################################################
set -e  
PWD=$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )
source $PWD/../oracle2gp_path.sh

############################################################################################################################
#
# Make sure Outsourcer UI hasn't already started
#
############################################################################################################################
check=$(ps -ef 2> /dev/null | grep $OSJAR | grep UI | grep -v grep | wc -l)

if [ $check = 1 ]; then
        echo "Outsourcer UI has already started!"
        exit 0
fi
############################################################################################################################
#
# Reset the os.sessions table
#
############################################################################################################################

if [ -f $SESSIONS ]; then
	rm $SESSIONS
fi
touch $SESSIONS

echo "Removed old sessions"
############################################################################################################################
#
# Start Outsourcer UI
#
############################################################################################################################
echo "Starting Outsourcer UI..."

nohup java -classpath $OSUICLASSPATH -Xms16M -Xmx128M UI $UIPORT $SESSIONS $CONFIG > $UILOG 2>&1 < $UILOG &

gpfdiststart
